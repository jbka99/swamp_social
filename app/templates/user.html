{% extends "base.html" %}

{% block title %}Профиль {{ user.username }}{% endblock %}

{% block content %}
<div class="row g-4">

  <!-- Профиль пользователя -->
  <div class="col-12 col-lg-4">
    <div class="card bg-black border border-secondary shadow-sm">
      <div class="card-body">

        <div class="d-flex align-items-center gap-3">
          <img
            src="{{ user.avatar_url if user.avatar_url else 'https://api.dicebear.com/7.x/identicon/svg?seed=' + user.username }}"
            alt="Avatar"
            class="rounded-circle border border-secondary"
            style="width: 72px; height: 72px; object-fit: cover;"
            referrerpolicy="no-referrer"
          >

          <div class="flex-grow-1">
            <div class="h5 mb-0 fw-bold">
              {{ user.display_name or user.username }}
            </div>
            <div class="text-secondary small">
              @{{ user.username }}
            </div>
          </div>
        </div>

        <hr class="border-secondary my-4">

        <div class="text-secondary small mb-1">Возраст</div>
        <div class="mb-3">
          {{ user.age or 'не указан' }}
        </div>

        <div class="text-secondary small mb-1">О себе</div>
        {% set bio = (user.bio or '')|trim %}
        <div class="text-light-emphasis" style="white-space: pre-wrap;">
          {{ bio if bio else 'Пользователь еще ничего не рассказал о себе.' }}
        </div>

        <div class="mt-4 d-grid gap-2">

          {% if current_user.is_authenticated and user.username == current_user.username %}
            <a class="btn btn-outline-success" href="{{ url_for('routes.index') }}">Мой профиль</a>
            <a class="btn btn-outline-success" href="{{ url_for('routes.settings') }}">Настройки</a>
          {% endif %}
        </div>

      </div>
    </div>
  </div>

  <!-- Посты пользователя -->
  <div class="col-12 col-lg-8">
    <div class="d-flex align-items-center justify-content-between mb-2">
      <div class="h5 mb-0 fw-bold">Записи пользователя</div>
    </div>

    {% if posts and posts|length > 0 %}
      <div class="posts-list">
        {% for post in posts %}
          {% include "components/_post_card.html" %}
        {% endfor %}
      </div>
    {% else %}
      <div class="card bg-black border border-secondary shadow-sm">
        <div class="card-body text-secondary">
          У пользователя пока нет постов.
        </div>
      </div>
    {% endif %}
  </div>

</div>
{% endblock %}